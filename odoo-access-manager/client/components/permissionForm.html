<!-- 
Este archivo define el formulario para gestionar permisos, permitiendo a los usuarios agregar o modificar permisos.
-->

<div class="permission-form">
    <h2>Gestión de Permisos</h2>
    <form id="form-permission" onsubmit="handlePermissionSubmit(event)">
        <div class="form-group">
            <label for="user">Usuario:</label>
            <select id="user" name="user" required>
                <!-- Opciones de usuarios se llenarán dinámicamente -->
            </select>
        </div>
        <div class="form-group">
            <label for="permission">Permiso:</label>
            <select id="permission" name="permission" required>
                <option value="read">Leer</option>
                <option value="write">Escribir</option>
                <option value="delete">Eliminar</option>
                <!-- Agregar más permisos según sea necesario -->
            </select>
        </div>
        <div class="form-group">
            <button type="submit">Guardar Permiso</button>
        </div>
    </form>
    <div id="permission-message"></div>
</div>

<script>
    function handlePermissionSubmit(event) {
        event.preventDefault();
        const user = document.getElementById('user').value;
        const permission = document.getElementById('permission').value;

        // Lógica para enviar los datos al servidor y gestionar permisos
        google.script.run.withSuccessHandler(showMessage).managePermission(user, permission);
    }

    function showMessage(response) {
        document.getElementById('permission-message').innerText = response;
    }
</script>